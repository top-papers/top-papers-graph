# Week 11 — PyTorch Geometric (GNN) + оценка link prediction

## Цели занятия

- Понять ключевые понятия недели и как они нужны проекту.
- Получить артефакт/изменение в репозитории по итогам практики.

## Теория (простыми словами)

Почему нужен GNN‑режим:
- Классические эвристики (Adamic–Adar, Jaccard, Preferential Attachment) хорошо работают как baseline,
  но часто «не видят» сложные паттерны (особенно в шумном графе).
- **Graph Neural Networks** учат представления вершин/ребер через message passing и могут давать
  более «семантические» кандидаты ребер.

Что именно мы делаем в проекте:
- **Link prediction** на графе термов (кандидаты гипотез ≈ «пропущенные ребра»).
- Реализован опциональный режим `HYP_GNN_ENABLED=1` через **PyTorch Geometric**:
  - строим датасет из NetworkX графа,
  - обучаем простую модель (например, GraphSAGE) на задаче предсказания ребер,
  - возвращаем top‑k предсказаний как кандидаты гипотез.

Метрики качества (минимум):
- Для link prediction: precision@k / hits@k / MAP (если делаем holdout сплит).
- Для гипотез: novelty, soundness, testability (экспертные шкалы).

## Практика в контексте проекта

1) Включить GNN‑режим (если ставили extras):
   - установить зависимости: `pip install -e ".[gnn]"` (опционально `.[gnn_ext]`)
   - в `.env`: `HYP_GNN_ENABLED=1`

2) Прогнать demo‑пайплайн и посмотреть, появляются ли **новые** гипотезы:
   ```bash
   top-papers-graph demo-run --edge-mode cooccurrence
   ```

3) Сравнить 2–3 варианта генерации кандидатов (ablations):
   - только `link_prediction` (эвристики)
   - `spectral_link_prediction` (векторный baseline)
   - `gnn_link_prediction` (PyG)

4) (если есть размеченные данные/эксперты начали разметку) собрать мини‑оценку:
   - сделать holdout на ребрах (например, 10%) и измерить hits@k
   - собрать 20 экспертных оценок гипотез по шкалам novelty/soundness/testability

## Что сдаём (deliverables)

- Короткий отчёт (5–10 предложений) + ссылка на артефакты/PR.
- 1–2 скриншота/фрагмента `temporal_kg.json` или `hypotheses.json` с комментариями.
- Список следующих вопросов/рисков (что непонятно, что хочется улучшить).

Плюс (желательно):
- маленькая таблица сравнения (3 строки × 3 метрики): heuristics vs spectral vs GNN.
